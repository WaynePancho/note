# <center>欧拉算法

## 欧拉算法的内容

牛顿冷却定律是一个一阶常微分方程，对于一般的一阶常微分方程

$$
\frac{\mathrm{d}y}{\mathrm{d}x} = f(x,y)
$$

常用的数值解法是欧拉算法。欧拉算法的核心是把微分方程转化为差分方程，即

- 通过在旧的$x$上加上新的$\Delta x$来得到新的$x^{\prime}=x+\Delta x$
- 通过在旧的$(x,t)$处的斜率$f(x,t)$来近似新的$y^{\prime}\approx y+f(x,y)\Delta x$

迭代这个过程，通过恒定斜率近似导数，可以逐步估计下一点的值。迭代公式为

$$
x_{n+1}=x_n + \Delta x\\
y_{n+1}=y_n+f(x_n,y_n)\Delta x
$$

由于欧拉算法在每一步中设定恒定斜率来估计下一点的值，它也被称为恒斜率法。


## 例子：dy/dx=2x

### 求解

考虑一阶微分方程

$$
\frac{\mathrm{d}y}{\mathrm{d}x} = 2x
$$

并附加初始条件$x_0=1.0,y_0=1.0$，用欧拉算法讨论$x\in[1,2]$区间中方程的数值解。

积分可以解出精确的解析解为$y=x^2$。现在使用欧拉法对其求解，本例中$f(x,y)=2x$。将初始条件作为迭代起点

$$
x(0)=1.0,\quad y(0)=1.0
$$

选定迭代步长为$\Delta x=0.1$，逐次迭代，第一次迭代得到

$$
x(1)=x(0)+\Delta x=1.1,\quad y(1)=y(0)+f(1.0,1.0)\Delta x = 1.0+2\times 0.1=1.20
$$

第二次迭代得到

$$
x(2)=x(1)+\Delta x=1.2,\quad y(2)=y(1)+f(1.1,1.2)\Delta x = 1.2+2.2\times 0.1=1.42
$$

逐次迭代到$x(10)=2.0$可以得到如下表格

| $n$  | $x(n)$ | $y(n)$ | 斜率$f(x,y)=2x$ | $y(n+1)=y(n)+f(x,y)\times 0.1$ | 精确值$y_0(n)=x^2(n)$ | 误差$y(n)-y_0(n)$ |
| :--: | :----: | :----: | :-------------: | :----------------------------: | :-------------------: | :---------------: |
|  0   |  1.00  |  1.00  |      2.00       |   1.00 + 2.00 * 0.10 = 1.20    |         1.00          |       0.00        |
|  1   |  1.10  |  1.20  |      2.20       |   1.20 + 2.20 * 0.10 = 1.42    |         1.21          |       0.01        |
|  2   |  1.20  |  1.42  |      2.40       |   1.42 + 2.40 * 0.10 = 1.66    |         1.44          |       0.02        |
|  3   |  1.30  |  1.66  |      2.60       |   1.66 + 2.60 * 0.10 = 1.92    |         1.69          |       0.03        |
|  4   |  1.40  |  1.92  |      2.80       |   1.92 + 2.80 * 0.10 = 2.20    |         1.96          |       0.04        |
|  5   |  1.50  |  2.20  |      3.00       |   2.20 + 3.00 * 0.10 = 2.50    |         2.25          |       0.05        |
|  6   |  1.60  |  2.50  |      3.20       |   2.50 + 3.20 * 0.10 = 2.82    |         2.56          |       0.06        |
|  7   |  1.70  |  2.82  |      3.40       |   2.82 + 3.40 * 0.10 = 3.16    |         2.89          |       0.07        |
|  8   |  1.80  |  3.16  |      3.60       |   3.16 + 3.60 * 0.10 = 3.52    |         3.24          |       0.08        |
|  9   |  1.90  |  3.52  |      3.80       |   3.52 + 3.80 * 0.10 = 3.90    |         3.61          |       0.09        |
|  10  |  2.00  |  3.90  |      4.00       |               -                |           -           |       0.10        |

其中$y(n+1)=y(n)+f(x,y)\times 0.1$一列的数据就是欧拉法的数值估计结果。

### 误差分析

由表格可看出，使用恒定导数进行近似数值计算具j有一定误差。随着迭代次数增多，数值解相比解析解的误差$\Delta y=y(n)-y_0(n)$逐次增大，具体误差为

- 每一步的误差约为$(\Delta x)^2$:对比精确解
- 最终结果的误差约为$\Delta x$

即每一步的误差是步长的平方，而最终累积的误差和步长成正比。